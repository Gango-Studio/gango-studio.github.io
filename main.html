<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" style="filter: grayscale(0%);">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312;width= device-width,user-scalable = 0" />
<meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Gango Studios</title>
<style>
  /* 基础样式保持不变... */
  
  /* 横屏/电脑端专用样式 */
  @media (min-width: 769px), (orientation: landscape) {
      .nav-menu {
          flex-direction: row;
      }
      .current-page-title {
          display: none;
      }
      /* 新增：横向二级导航样式 */
      .sub-nav-menu {
          position: absolute;
          top: 100%;
          left: 0;
          width: 100%;
          display: none; /* 默认隐藏 */
          flex-direction: row;
          flex-wrap: nowrap;
          justify-content: center;
          padding: 5px 0;
          background: #f8f8f8;
          box-shadow: 0 4px 8px rgba(0,0,0,0.1);
          z-index: 100;
      }
      .sub-nav-item {
          flex: 1;
          padding: 0 !important;
          text-align: center;
          white-space: nowrap;
      }
      .sub-nav-link {
          display: inline-block;
          padding: 8px 12px !important;
          border-radius: 4px;
          transition: background 0.2s;
      }
      .sub-nav-link:hover {
          background: rgba(0,122,255,0.1);
      }
      .nav-item {
          position: static; /* 修复定位上下文 */
      }
  }

  /* 手机竖屏专用样式（保持不变） */
  @media (max-width: 768px) and (orientation: portrait) {
      .nav-menu {
          flex-direction: column;
          display: none;
      }
      .nav-menu.expanded {
          display: flex;
      }
      .current-page-title {
          display: flex;
      }
      .sub-nav-menu {
          display: none;
          width: 100%;
          padding-left: 20px;
          background: #f0f0f0;
      }
      .sub-nav-item {
          padding-left: 15px;
      }
  }
</style>
</head>
<body>
<!-- HTML结构保持不变... -->

<script>
document.addEventListener('DOMContentLoaded', function() {
    const navMenu = document.getElementById('navMenu');
    const currentPageTitle = document.getElementById('currentPageTitle');
    
    // 判断是否为手机竖屏模式
    function isMobilePortrait() {
        return window.innerWidth < 768 && window.matchMedia("(orientation: portrait)").matches;
    }
    
    // 关闭所有子菜单
    function closeAllSubMenus() {
        document.querySelectorAll('.sub-nav-menu').forEach(menu => {
            menu.style.display = 'none';
            const icon = menu.previousElementSibling?.querySelector('.collapse-icon');
            if (icon) icon.style.transform = '';
        });
    }
    
    // 初始化导航栏状态
    function initNavbar() {
        if (isMobilePortrait()) {
            // 手机竖屏模式
            navMenu.style.display = 'none';
            currentPageTitle.style.display = 'flex';
            closeAllSubMenus();
        } else {
            // 桌面端或横屏模式
            navMenu.style.display = 'flex';
            currentPageTitle.style.display = 'none';
            closeAllSubMenus();
        }
    }
    
    // 处理一级导航点击
    function handlePrimaryNavClick(e) {
        const navLink = e.target.closest('.nav-link');
        if (!navLink) return;
        
        const navItem = navLink.parentElement;
        
        if (navItem.classList.contains('has-submenu')) {
            e.preventDefault();
            e.stopPropagation();
            
            const subMenu = navItem.querySelector('.sub-nav-menu');
            const isExpanded = subMenu.style.display === (isMobilePortrait() ? 'block' : 'flex');
            const collapseIcon = navLink.querySelector('.collapse-icon');
            
            if (!isMobilePortrait()) {
                // 横屏/电脑端处理
                if (!isExpanded) {
                    closeAllSubMenus();
                }
                subMenu.style.display = isExpanded ? 'none' : 'flex';
            } else {
                // 手机竖屏处理
                subMenu.style.display = isExpanded ? 'none' : 'block';
            }
            
            if (collapseIcon) {
                collapseIcon.style.transform = isExpanded ? '' : 'rotate(90deg)';
            }
        }
    }
    
    // 处理二级导航点击
    function handleSecondaryNavClick(e) {
        const subNavLink = e.target.closest('.sub-nav-link');
        if (!subNavLink) return;
        
        e.preventDefault();
        const subNavItem = subNavLink.parentElement;
        const targetId = subNavLink.getAttribute('href');
        
        // 更新活动状态
        document.querySelectorAll('.sub-nav-item').forEach(item => {
            item.classList.remove('active');
        });
        subNavItem.classList.add('active');
        
        // 滚动到目标位置
        if (targetId) {
            document.querySelector(targetId)?.scrollIntoView({
                behavior: 'smooth'
            });
        }
        
        // 如果是手机竖屏，点击后折叠整个菜单
        if (isMobilePortrait()) {
            navMenu.style.display = 'none';
            currentPageTitle.querySelector('.collapse-icon').style.transform = '';
            closeAllSubMenus();
        }
    }
    
    // 处理当前页面标题点击（手机竖屏）
    function handleCurrentTitleClick() {
        if (!isMobilePortrait()) return;
        
        const isExpanded = navMenu.style.display === 'flex';
        navMenu.style.display = isExpanded ? 'none' : 'flex';
        this.querySelector('.collapse-icon').style.transform = isExpanded ? '' : 'rotate(90deg)';
        
        // 如果折叠菜单，同时折叠所有子菜单
        if (isExpanded) {
            closeAllSubMenus();
        }
    }
    
    // 初始化事件监听
    function initEventListeners() {
        // 一级导航点击
        document.querySelectorAll('.nav-item.has-submenu .nav-link').forEach(link => {
            link.addEventListener('click', handlePrimaryNavClick);
        });
        
        // 二级导航点击
        document.querySelectorAll('.sub-nav-link').forEach(link => {
            link.addEventListener('click', handleSecondaryNavClick);
        });
        
        // 手机竖屏下的标题点击
        currentPageTitle.addEventListener('click', handleCurrentTitleClick);
        
        // 窗口大小变化时重新初始化
        window.addEventListener('resize', initNavbar);
        
        // 桌面端点击页面其他区域关闭子菜单
        if (!isMobilePortrait()) {
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.nav-item.has-submenu')) {
                    closeAllSubMenus();
                }
            });
        }
    }
    
    // 处理hash导航
    function initHashNavigation() {
        const hash = window.location.hash;
        if (hash) {
            const targetItem = document.querySelector(`.sub-nav-item[data-section="${hash.substring(1)}"]`);
            if (targetItem) {
                targetItem.classList.add('active');
                
                // 展开对应的父菜单
                const parentMenu = targetItem.closest('.sub-nav-menu');
                if (parentMenu) {
                    parentMenu.style.display = isMobilePortrait() ? 'block' : 'flex';
                    const navLink = parentMenu.previousElementSibling;
                    if (navLink && navLink.classList.contains('nav-link')) {
                        const icon = navLink.querySelector('.collapse-icon');
                        if (icon) icon.style.transform = 'rotate(90deg)';
                    }
                    
                    // 如果是手机竖屏，展开主菜单
                    if (isMobilePortrait()) {
                        navMenu.style.display = 'flex';
                        currentPageTitle.querySelector('.collapse-icon').style.transform = 'rotate(90deg)';
                    }
                }
            }
        }
    }
    
    // 初始化
    initNavbar();
    initEventListeners();
    initHashNavigation();
});
</script>
</body>
</html>
